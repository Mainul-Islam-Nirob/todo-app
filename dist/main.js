(()=>{const t=(e,t,n,o)=>({title:e,description:t,dueDate:n,priority:o}),n=e=>({name:e,todos:[]}),o=[],d=e=>{const t=n(e);o.push(t),y(),l()};console.log(o);let c=null;const l=()=>{const e=document.getElementById("project-list");e.innerHTML="",o.forEach(((t,n)=>{const d=document.createElement("div");d.classList.add("project");const s=document.createElement("span");s.classList.add("project-name"),s.textContent=t.name,s.addEventListener("click",(()=>{document.querySelectorAll(".project-name").forEach((e=>e.classList.remove("project-active"))),s.classList.add("project-active"),i(n)}));const a=document.createElement("div");a.classList.add("projectBtns");const m=document.createElement("i");m.classList.add("projectBtn","fa-solid","fa-pen-to-square"),m.onclick=()=>(e=>{c=e,document.getElementById("projectName").value=o[e].name,document.getElementById("projectModalTitle").textContent="Update Project",r("projectModal")})(n);const p=document.createElement("i");p.classList.add("projectBtn","fa-regular","fa-trash"),p.onclick=()=>(e=>{confirm("Are you sure you want to delete this project and all its todos?")&&(o.splice(e,1),y(),l(),document.getElementById("todo-list").innerHTML="")})(n);const E=document.createElement("i");E.classList.add("projectBtn","fa-sharp","fa-solid","fa-plus"),E.onclick=()=>{u=n,r("todoModal")},a.appendChild(m),a.appendChild(p),a.appendChild(E),d.appendChild(s),d.appendChild(a),e.appendChild(d)}))};let s=null;const i=e=>{const t=document.getElementById("todo-list");t.innerHTML="",console.log("project index",e),o[e].todos.forEach(((n,d)=>{console.log("todo from loop",n,d);const c=document.createElement("div");c.classList.add("todoItem");const l=document.createElement("div");l.classList.add("t-title"),l.textContent=n.title,c.appendChild(l);const a=document.createElement("div");a.classList.add("t-description"),a.textContent=n.description,c.appendChild(a);const m=document.createElement("div");m.classList.add("t-priority"),m.textContent=`Priority: ${n.priority}`,c.appendChild(m);const u=document.createElement("div");u.classList.add("t-dueDate"),u.textContent=`Due: ${n.dueDate}`,c.appendChild(u);const v=document.createElement("div");v.classList.add("projectName"),v.textContent=`Project: ${o[e].name}`,c.appendChild(v);const g=document.createElement("div");g.classList.add("edit-item");const h=document.createElement("span");h.classList.add("edit-btn"),h.textContent="Edit",h.onclick=()=>((e,t)=>{s=t;const n=o[e].todos[t];document.getElementById("title").value=n.title,document.getElementById("details").value=n.description,document.getElementById("date").value=n.dueDate,p=n.priority,E("Low"===p?"low-btn":"high-btn","High"===p?"low-btn":"high-btn"),document.getElementById("todoModalTitle").textContent="Update Task",r("todoModal")})(e,d),g.appendChild(h);const I=document.createElement("span");I.classList.add("edit-btn"),I.textContent="Delete",I.addEventListener("click",(()=>{o[e].todos.splice(d,1),i(e),y()})),g.appendChild(I),c.appendChild(g),t.appendChild(c)}))},a=()=>{document.getElementById("todo-form").reset(),document.getElementById("project-form").reset(),p="",s=null,c=null,document.getElementById("todoModalTitle").textContent="New Task",document.getElementById("projectModalTitle").textContent="New Project"},r=t=>{const n=document.getElementById(t);n.style.display="block",n.querySelector(".closeBtn").addEventListener("click",(()=>{n.style.display="none",a()})),window.addEventListener("click",m(e,t))};function m(e,t){const n=document.getElementById(t);document.getElementById(".modal-content").contains(e.target)||(n.style.display="none",a(),window.removeEventListener("click",(e=>m(e,t))))}let p="";document.getElementById("low-btn").addEventListener("click",(()=>{p="Low",E("low-btn","high-btn")})),document.getElementById("high-btn").addEventListener("click",(()=>{p="High",E("high-btn","low-btn")}));let u=0;function E(e,t){console.log("Selected ID:",e),console.log("Other ID:",t);const n=document.getElementById(e),o=document.getElementById(t);n&&(n.classList.add("selected"),console.log(n),console.log("change selected button style")),o&&(o.classList.remove("selected"),console.log("change other button style"))}document.getElementById("show-todo-modal").addEventListener("click",(()=>r("todoModal"))),document.getElementById("show-project-modal").addEventListener("click",(()=>r("projectModal"))),document.getElementById("todo-form").addEventListener("submit",(e=>{e.preventDefault();const n=document.getElementById("title").value,d=document.getElementById("details").value,c=document.getElementById("date").value;if(!p)return void alert("Please select a priority!");const l=p;if(null!==s){const e=u;o[e].todos[s]=t(n,d,c,l),i(e),s=null}else{const e=t(n,d,c,l);((e,t)=>{console.log("from add to do project",t),o[e].todos.push(t),y(),i(e)})(u,e)}y(),document.getElementById("todoModal").style.display="none",E(),a()})),document.getElementById("project-form").addEventListener("submit",(e=>{e.preventDefault();const t=document.getElementById("projectName").value;null!==c?(o[c].name=t,l(),c=null):d(t),y(),document.getElementById("projectModal").style.display="none",a()})),document.getElementById("importantNav").addEventListener("click",(()=>{const e=document.getElementById("todo-list");e.innerHTML="";const t=o.flatMap(((e,t)=>e.todos.filter((e=>"High"===e.priority)).map((e=>({...e,projectIndex:t})))));0!==t.length?t.forEach((t=>{const n=document.createElement("div");n.classList.add("todoItem"),n.innerHTML=`\n          <div class="t-title">${t.title}</div>\n          <div class="t-details">${t.description}</div>\n          <div class="t-priority">Priority: ${t.priority}</div>\n          <div class="t-dueDate">Due: ${t.dueDate}</div>\n          <div class="projectName">Project: ${o[t.projectIndex].name}</div>\n         \n      `,e.appendChild(n)})):e.innerHTML="<p>No high-priority todos found.</p>"})),document.getElementById("show-all-todos").addEventListener("click",(()=>{const e=document.getElementById("todo-list");e.innerHTML="";const t=o.flatMap(((e,t)=>e.todos.map((e=>({...e,projectIndex:t})))));if(0===t.length){const t=document.createElement("p");return t.textContent="No todos found.",void e.appendChild(t)}t.forEach(((t,n)=>{const d=document.createElement("div");d.classList.add("todoItem"),d.innerHTML=`\n          <div class="t-title">${t.title}</div>\n          <div class="t-description">${t.description}</div>\n          <div class="t-priority">Priority: ${t.priority}</div>\n          <div class="t-dueDate">Due: ${t.dueDate}</div>\n          <div class="projectName">Project: ${o[t.projectIndex].name}</div>\n          <div class="edit-item">\n              <span class="edit-btn" onclick="editTodo(${t.projectIndex}, ${n})">Edit</span>\n              <span class="edit-btn" onclick="deleteTodo(${t.projectIndex}, ${n})">Delete</span>\n          </div>\n      `,e.appendChild(d)}))}));const y=()=>{localStorage.setItem("todoAppData",JSON.stringify(o))};document.addEventListener("DOMContentLoaded",(()=>{(()=>{const e=localStorage.getItem("todoAppData");if(e)JSON.parse(e).forEach((e=>{const d=n(e.name);e.todos.forEach((e=>{d.todos.push(t(e.title,e.description,e.dueDate,e.priority))})),o.push(d)})),l(),o.length>0&&i(0);else{const e=d("Default List");y(),l(),i(o.indexOf(e))}})()}))})();